**When to use each?**
- Active Directory - Integrated
    - When you have already logged into your on-prem domain
    - When you want to minimize auth. prompts
- Application token authentication
    - Not for humans; for apps


**Connect Web App to Azure SQL?** 
1. AAD - create a system assigned managed identity
2. In the Azure SQL Database, create a contained user

```bash
az webapp identity assign --resource-group myResourceGroup --name <app-name>
```

Output:
```json
{
  "additionalProperties": {},
  "principalId": "21dfa71c-9e6f-4d17-9e90-1d28801c9735",
  "tenantId": "72f988bf-86f1-41af-91ab-2d7cd011db47",
  "type": "SystemAssigned"
}
```

Grant permissions to the identity:
```shell
groupid=$(az ad group create --display-name myAzureSQLDBAccessGroup --mail-nickname myAzureSQLDBAccessGroup --query objectId --output tsv)
msiobjectid=$(az webapp identity show --resource-group myResourceGroup --name <app-name> --query principalId --output tsv)
az ad group member add --group $groupid --member-id $msiobjectid
az ad group member list -g $groupid
```

```sql
CREATE USER [<identity-name>] FROM EXTERNAL PROVIDER;
ALTER ROLE db_datareader ADD MEMBER [<identity-name>];
ALTER ROLE db_datawriter ADD MEMBER [<identity-name>];
ALTER ROLE db_ddladmin ADD MEMBER [<identity-name>];
GO
```


